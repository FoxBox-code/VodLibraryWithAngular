<p>play-video works!</p>


  <video [src]="selectedVideo?.videoPath" controls width="640"></video>
  <h2>{{selectedVideo?.title}}</h2>
  <p>{{selectedVideo?.description}}</p>
  <section>{{selectedVideo?.videoOwnerName}} Uploaded : {{selectedVideo?.uploaded}}</section>
  <section>Views:{{views$ | async}}
    <ng-container *ngIf="reaction">
        <button type="button" (click)="addReaction('Like')">Likes  : {{reaction.likeCount}}</button>
        <button type="button" (click)="addReaction('Dislike')">DisLikes : {{reaction.disLikeCount}}</button>
    </ng-container>

  </section>
  <p>Comments : {{commentsCountObservable | async }}</p>

<section *ngIf="userName ; else userIsNotLogged" >
  <form [formGroup]="commentForm" (ngSubmit)="addComment()">
    <label id="comment"></label>
    <textarea id="comment" formControlName="Comment"></textarea>
    <button type="submit" [disabled]="!commentForm.valid">Comment</button>
    <button type="reset" >Cancel</button>
  </form>
</section>

<ng-template #userIsNotLogged>
  <p>Register to comment on the video</p>
  <button type="button" (click)="navigateToLogIn()">Log In</button>
</ng-template>



<ng-container *ngIf="commentsCountObservable | async; else NoComments">
  <button *ngIf="!videoComments$" type="button" (click)="loadComments()">Load comments</button>
  <button *ngIf="videoComments$" type="button" (click)="toggleCommentsShowHide()">{{autoLoadComments ? "Hide comments" : "Load comments"}}</button>
      <section *ngIf="autoLoadComments">
          <section *ngFor="let comment of videoComments$ | async">

          <p>{{comment.userName}}: {{comment.uploaded}}</p>
          <p>{{comment.description}}</p>
          <p>
            <button type="button" (click)="addCommentReaction(comment.id, true)">Likes : {{comment.likes}} </button>
            <button type="button" (click)="addCommentReaction(comment.id, false)">Dislikes : {{comment.disLikes}}</button>
            Replies {{comment.repliesCount}}
          </p>

          <section *ngIf="userName">
          <button type="button" (click)="getReplyForm(comment.id)">Reply</button>

          <form *ngIf="replyForm && activeCommentId === comment.id" [formGroup]="replyForm" (ngSubmit)="addReply()">
            <label id="reply"></label>
            <textarea id="reply" formControlName="Reply"></textarea>
            <button type="submit" [disabled]="replyForm.invalid">Reply to comment</button>
            <button type="reset">Cancel</button>
          </form>
          </section>

          <p></p>

          <section *ngIf="comment.repliesCount > 0">
            <button type="button" (click)="getRepliesForCommnet(comment.id)">{{expandRepliesComments[comment.id] ? 'Hide' : 'Load replies'}}</button>

              <section *ngIf="expandRepliesComments[comment.id]">
                <ng-container *ngFor="let reply of commentReplies$[comment.id] | async">
                  <p>{{reply.userName}} : {{reply.uploaded}}</p>
                  <p>{{reply.description}}</p>
                  <p>Likes {{reply.likes}} DisLikes {{reply.disLikes}}</p>
                </ng-container>
              </section>

              <div>_________________________________</div>
          </section>

        </section>
      </section>

    </ng-container>



    <ng-template #NoComments>
        No comments on this video yet!
    </ng-template>









